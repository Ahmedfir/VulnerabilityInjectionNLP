# Recreate the nb_tokens_{bads|goods}.txt
import os
import subprocess

dest_folder = "/mnt/docker/test_main_python_5CWE_req_only_token150_InferOK_obfuscated_same_normal_dataset/4_Splitted_tokens_and_unique_txt_file"

cmd = "awk '{ print NF }' " + os.path.join(dest_folder,'bads.txt')  # Count nb of token for each line of the txt file
results = subprocess.check_output(cmd, shell=True)
all_counts_bads = [int(result) for result in (str(results)[2:-1]).split("\\n") if result != '']
with open(os.path.join(dest_folder,'nb_tokens_bads.txt'), 'a') as destfile:
    for token_number in all_counts_bads:
        destfile.write(str(token_number)+"\n")

# Count and log the number of tokens in the good file
cmd = "awk '{ print NF }' " + os.path.join(dest_folder,'goods.txt')  # Count nb of token for each line of the txt file
results = subprocess.check_output(cmd, shell=True)
all_counts_goods = [int(result) for result in (str(results)[2:-1]).split("\\n") if result != '']
with open(os.path.join(dest_folder, 'nb_tokens_goods.txt'),
          'a') as destfile:
    for token_number in all_counts_goods:
        destfile.write(str(token_number) + "\n")